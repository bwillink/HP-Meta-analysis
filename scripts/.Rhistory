length(unique(dat_1$Experiment[dat_1$Gradient.category == "Pollution" & dat_1$Trait.type == "Survivorship"])),
length(unique(dat_1$Experiment[dat_1$Gradient.category == "Resource" & dat_1$Trait.type == "Fecundity"])),
length(unique(dat_1$Experiment[dat_1$Gradient.category == "Resource" & dat_1$Trait.type == "Survivorship"]))
),
N_host_taxa = c(length(unique(dat_1$Host[dat_1$Gradient.category == "Environment" & dat_1$Trait.type == "Fecundity"])),
length(unique(dat_1$Host[dat_1$Gradient.category == "Environment" & dat_1$Trait.type == "Survivorship"])),
length(unique(dat_1$Host[dat_1$Gradient.category == "Pollution" & dat_1$Trait.type == "Fecundity"])),
length(unique(dat_1$Host[dat_1$Gradient.category == "Pollution" & dat_1$Trait.type == "Survivorship"])),
length(unique(dat_1$Host[dat_1$Gradient.category == "Resource" & dat_1$Trait.type == "Fecundity"])),
length(unique(dat_1$Host[dat_1$Gradient.category == "Resource" & dat_1$Trait.type == "Survivorship"]))
))
rownames(Table2) <- NULL
Table2 %>%
kbl() %>%
kable_material(c("striped", "hover"), full_width = F)
Q1.f_OP <-
orchard_plot(
Q1.f,
xlab = "Standardised mean difference (Hedge's g)",
transfm = "none",
angle = 0,
alpha = 0.7
) +
scale_fill_manual(values = rep(pal, each = 2)) + scale_colour_manual(values = rep(pal, each = 2)) +
theme(legend.position = c(0.5, 0.1), axis.title = element_text(size = 15), axis.text.y = element_text(size = 15)) +
scale_y_discrete(
labels = c(
"Infected:EE:fecund",
"Uninfected:EE:fecund",
"Infected:EE:surv",
"Uninfected:EE:surv",
"Infected:CP:fecund",
"Uninfected:CP:fecund",
"Infected:CP:surv",
"Uninfected:CP:surv",
"Infected:RL:fecund",
"Uninfected:RL:fecund",
"Infected:RL:surv",
"Uninfected:RL:surv"
)
)
pal <- RColorBrewer::brewer.pal(6,"Spectral")
Q1.f_OP <-
orchard_plot(
Q1.f,
xlab = "Standardised mean difference (Hedge's g)",
transfm = "none",
angle = 0,
alpha = 0.7
) +
scale_fill_manual(values = rep(pal, each = 2)) + scale_colour_manual(values = rep(pal, each = 2)) +
theme(legend.position = c(0.5, 0.1), axis.title = element_text(size = 15), axis.text.y = element_text(size = 15)) +
scale_y_discrete(
labels = c(
"Infected:EE:fecund",
"Uninfected:EE:fecund",
"Infected:EE:surv",
"Uninfected:EE:surv",
"Infected:CP:fecund",
"Uninfected:CP:fecund",
"Infected:CP:surv",
"Uninfected:CP:surv",
"Infected:RL:fecund",
"Uninfected:RL:fecund",
"Infected:RL:surv",
"Uninfected:RL:surv"
)
)
Q1.f_OP
Q1.f_OP <-
orchard_plot(
Q1.f,
xlab = "Standardised mean difference (Hedge's g)",
transfm = "none",
angle = 0,
alpha = 0.7
) +
scale_fill_manual(values = rep(pal, each = 2)) + scale_colour_manual(values = rep(pal, each = 2)) +
theme(legend.position = c(0.1, 0.1), axis.title = element_text(size = 15), axis.text.y = element_text(size = 15)) +
scale_y_discrete(
labels = c(
"Infected:EE:fecund",
"Uninfected:EE:fecund",
"Infected:EE:surv",
"Uninfected:EE:surv",
"Infected:CP:fecund",
"Uninfected:CP:fecund",
"Infected:CP:surv",
"Uninfected:CP:surv",
"Infected:RL:fecund",
"Uninfected:RL:fecund",
"Infected:RL:surv",
"Uninfected:RL:surv"
)
)
Q1.f_OP
Q1.f_OP <-
orchard_plot(
Q1.f,
xlab = "Standardised mean difference (Hedge's g)",
transfm = "none",
angle = 0,
alpha = 0.7
) +
scale_fill_manual(values = rep(pal, each = 2)) + scale_colour_manual(values = rep(pal, each = 2)) +
theme(legend.position = c(0.25, 0.1), axis.title = element_text(size = 15), axis.text.y = element_text(size = 15)) +
scale_y_discrete(
labels = c(
"Infected:EE:fecund",
"Uninfected:EE:fecund",
"Infected:EE:surv",
"Uninfected:EE:surv",
"Infected:CP:fecund",
"Uninfected:CP:fecund",
"Infected:CP:surv",
"Uninfected:CP:surv",
"Infected:RL:fecund",
"Uninfected:RL:fecund",
"Infected:RL:surv",
"Uninfected:RL:surv"
)
)
Q1.f_OP
Q1.f_OP
Q1.f_OP <-
orchard_plot(
Q1.f,
xlab = "Standardised mean difference (Hedge's g)",
transfm = "none",
angle = 0,
alpha = 0.7
) +
scale_fill_manual(values = rep(pal, each = 2)) + scale_colour_manual(values = rep(pal, each = 2)) +
theme(legend.position = c(0.25, 0.05), axis.title = element_text(size = 15), axis.text.y = element_text(size = 15)) +
scale_y_discrete(
labels = c(
"Infected:EE:fecund",
"Uninfected:EE:fecund",
"Infected:EE:surv",
"Uninfected:EE:surv",
"Infected:CP:fecund",
"Uninfected:CP:fecund",
"Infected:CP:surv",
"Uninfected:CP:surv",
"Infected:RL:fecund",
"Uninfected:RL:fecund",
"Infected:RL:surv",
"Uninfected:RL:surv"
)
)
Q1.f_OP
Q1.f_OP <-
orchard_plot(
Q1.f,
xlab = "Standardised mean difference (Hedge's g)",
transfm = "none",
angle = 0,
alpha = 0.7
) +
scale_fill_manual(values = rep(pal, each = 2)) + scale_colour_manual(values = rep(pal, each = 2)) +
theme(legend.position = c(0.25, 0.01), axis.title = element_text(size = 15), axis.text.y = element_text(size = 15)) +
scale_y_discrete(
labels = c(
"Infected:EE:fecund",
"Uninfected:EE:fecund",
"Infected:EE:surv",
"Uninfected:EE:surv",
"Infected:CP:fecund",
"Uninfected:CP:fecund",
"Infected:CP:surv",
"Uninfected:CP:surv",
"Infected:RL:fecund",
"Uninfected:RL:fecund",
"Infected:RL:surv",
"Uninfected:RL:surv"
)
)
Q1.f_OP
Q1.f_OP
Table2 <- data.frame(Stressor_type = c("Endogenous environment", "Endogenous environment", "Chemical pollution", "Chemical pollution", "Resource limitation","Resource limitation"),
Response_trait = c(rep(c("Fecundity", "Survivorship"), 3)),
Overall_mean = round(Q1$beta,3),
Lower_95 = round(Q1$ci.lb,3),
Upper_95 = round(Q1$ci.ub,3),
P_value = round(Q1$pval,3),
N_effects = c(length(dat_1$ID[dat_1$Gradient.category == "Environment" & dat_1$Trait.type == "Fecundity"]),
length(dat_1$ID[dat_1$Gradient.category == "Environment" & dat_1$Trait.type == "Survivorship"]),
length(dat_1$ID[dat_1$Gradient.category == "Pollution" & dat_1$Trait.type == "Fecundity"]),
length(dat_1$ID[dat_1$Gradient.category == "Pollution" & dat_1$Trait.type == "Survivorship"]),
length(dat_1$ID[dat_1$Gradient.category == "Resource" & dat_1$Trait.type == "Fecundity"]),
length(dat_1$ID[dat_1$Gradient.category == "Resource" & dat_1$Trait.type == "Survivorship"])),
N_experiments = c(length(unique(dat_1$Experiment[dat_1$Gradient.category == "Environment" & dat_1$Trait.type == "Fecundity"])),
length(unique(dat_1$Experiment[dat_1$Gradient.category == "Environment" & dat_1$Trait.type == "Survivorship"])),
length(unique(dat_1$Experiment[dat_1$Gradient.category == "Pollution" & dat_1$Trait.type == "Fecundity"])),
length(unique(dat_1$Experiment[dat_1$Gradient.category == "Pollution" & dat_1$Trait.type == "Survivorship"])),
length(unique(dat_1$Experiment[dat_1$Gradient.category == "Resource" & dat_1$Trait.type == "Fecundity"])),
length(unique(dat_1$Experiment[dat_1$Gradient.category == "Resource" & dat_1$Trait.type == "Survivorship"]))
),
N_host_taxa = c(length(unique(dat_1$Host[dat_1$Gradient.category == "Environment" & dat_1$Trait.type == "Fecundity"])),
length(unique(dat_1$Host[dat_1$Gradient.category == "Environment" & dat_1$Trait.type == "Survivorship"])),
length(unique(dat_1$Host[dat_1$Gradient.category == "Pollution" & dat_1$Trait.type == "Fecundity"])),
length(unique(dat_1$Host[dat_1$Gradient.category == "Pollution" & dat_1$Trait.type == "Survivorship"])),
length(unique(dat_1$Host[dat_1$Gradient.category == "Resource" & dat_1$Trait.type == "Fecundity"])),
length(unique(dat_1$Host[dat_1$Gradient.category == "Resource" & dat_1$Trait.type == "Survivorship"]))
))
rownames(Table2) <- NULL
Table2 %>%
kbl() %>%
kable_material(c("striped", "hover"), full_width = F)
Table2
pal <- RColorBrewer::brewer.pal(11,"Spectral")
Q1_OP <-
orchard_plot(
Q1,
xlab = "Standardised mean difference (Hedge's g)",
transfm = "none",
angle = 0,
alpha = 0.7
) +
scale_fill_manual(values = rep(pal[c(8,11,5)], each = 2)) + scale_colour_manual(values = rep(pal[c(8,11,5)], each = 2)) +
theme(legend.position = c(0.5, 0.1), axis.title = element_text(size = 15), axis.text.y = element_text(size = 15)) +
scale_y_discrete(
labels = c("EE:fecundity",
"EE:survivorship",
"CP:fecundity",
"CP:survivorship",
"RL:fecundity",
"RL:survivorship"))
Q1_OP
Q1_OP
Q1_OP <-
orchard_plot(
Q1,
xlab = "Standardised mean difference (Hedge's g)",
transfm = "none",
angle = 0,
alpha = 0.7
) +
scale_fill_manual(values = rep(pal[c(8,11,5)], each = 2)) + scale_colour_manual(values = rep(pal[c(8,11,5)], each = 2)) +
theme(legend.position = c(0.25, 0.01), axis.title = element_text(size = 15), axis.text.y = element_text(size = 15)) +
scale_y_discrete(
labels = c("EE:fecundity",
"EE:survivorship",
"CP:fecundity",
"CP:survivorship",
"RL:fecundity",
"RL:survivorship"))
Q1_OP
Q1_OP
Q2_OP
Q2_OP
par_short <- c("EE:prevalence", "EE:intensity","EE:fecundity", "EE:survivorship",
"CP:prevalence", "CP:intensity","CP:fecundity", "CP:survivorship",
"RL:prevalence", "RL:intensity","RL:fecundity","RL:survivorship")
pal <- RColorBrewer::brewer.pal(11,"Spectral")
Q2_OP <-
orchard_plot(
Q2,
xlab = "Standardised mean difference (Hedge's g)",
transfm = "none",
angle = 0,
alpha = 0.7
) +
theme(legend.position = c(0.3, 0.01), axis.title = element_text(size = 15), axis.text.y = element_text(size = 15)) +
scale_fill_manual(values = rep(pal[c(7,8,10,11,5,4)], each = 2)) +
scale_colour_manual(values = rep(pal[c(7,8,10,11,5,4)], each = 2)) +
scale_y_discrete(labels = par_short)
Q2_OP
Q2_OP
#absolute <- grep(pattern = "Fecundity|Survivorship|Intensity|Prevalence", x = dat_2$Trait.type)
#for(i in absolute){
#  dat_2$g[i] <- abs(dat_2$g[i])
#}
dat_2$absolute <- abs(dat_2$g)
View(dat)
View(dat_study)
View(dat_1)
dat_2$flipped <- dat_2$g
flip <- grep(pattern = "Intensity|Prevalence", x = dat_2$Trait.type)
for(i in flip){
dat_2$flipped[i] <- -dat_2$flipped[i]
}
Q2.flip <-
rma.mv(
flipped ~ Trait.type:Gradient.category -1,
V = varcovmat_2_PD$mat,
random = list(~ 1 | Experiment,  ~ 1 | ID),
data = dat_2,
method = "REML",
)
summary(Q2.flip)
forest.default(x= Q2.flip$beta, sei =  Q2.flip$se, ci.lb =  Q2.flip$ci.lb, ci.ub =  Q2.flip$ci.ub,
annotate=TRUE, showweights=T, header=F,
slab = c("EE:prevalence", "EE:intensity","EE:fecundity", "EE:survivorship",
"CP:prevalence", "CP:intensity","CP:fecundity", "CP:survivorship",
"RL:prevalence", "RL:intensity","RL:fecundity","RL:survivorship"))
# Environment
# Prevalence vs Fecundity
anova(Q2.flip, X=c(-1,0,1,0,0,0,0,0,0,0,0,0))
# Prevalence vs Survivorship
anova(Q2.flip, X=c(-1,0,0,1,0,0,0,0,0,0,0,0))
# Intensity vs Fecundity
anova(Q2.flip, X=c(0,-1,1,0,0,0,0,0,0,0,0,0))
# Intensity vs Survivorship
anova(Q2.flip, X=c(0,-1,0,1,0,0,0,0,0,0,0,0))
# Pollution
# Prevalence vs Fecundity
anova(Q2.flip, X=c(0,0,0,0,-1,0,1,0,0,0,0,0))
# Prevalence vs Survivorship
anova(Q2.flip, X=c(0,0,0,0,-1,0,0,1,0,0,0,0))
# Intensity vs Fecundity
anova(Q2.flip, X=c(0,0,0,0,0,-1,1,0,0,0,0,0))
# Intensity vs Survivorship
anova(Q2.flip, X=c(0,0,0,0,0,-1,0,1,0,0,0,0))
# Resources
# Prevalence vs Fecundity
anova(Q2.flip, X=c(0,0,0,0,0,0,0,0,-1,0,1,0))
# Prevalence vs Survivorship
anova(Q2.flip, X=c(0,0,0,0,0,0,0,0,-1,0,0,1))
# Intensity vs Fecundity
anova(Q2.flip, X=c(0,0,0,0,0,0,0,0,0,-1,1,0))
# Intensity vs Survivorship
anova(Q2.flip, X=c(0,0,0,0,0,0,0,0,0,-1,0,1))
Q2_OP
# Environment
# Prevalence vs Fecundity
anova(Q2.flip, X=c(-1,0,1,0,0,0,0,0,0,0,0,0))
# Prevalence vs Survivorship
anova(Q2.flip, X=c(-1,0,0,1,0,0,0,0,0,0,0,0))
# Intensity vs Fecundity
anova(Q2.flip, X=c(0,-1,1,0,0,0,0,0,0,0,0,0))
# Intensity vs Survivorship
anova(Q2.flip, X=c(0,-1,0,1,0,0,0,0,0,0,0,0))
# Pollution
# Prevalence vs Fecundity
anova(Q2.flip, X=c(0,0,0,0,-1,0,1,0,0,0,0,0))
# Prevalence vs Survivorship
anova(Q2.flip, X=c(0,0,0,0,-1,0,0,1,0,0,0,0))
# Intensity vs Fecundity
anova(Q2.flip, X=c(0,0,0,0,0,-1,1,0,0,0,0,0))
# Intensity vs Survivorship
anova(Q2.flip, X=c(0,0,0,0,0,-1,0,1,0,0,0,0))
# Resources
# Prevalence vs Fecundity
anova(Q2.flip, X=c(0,0,0,0,0,0,0,0,-1,0,1,0))
# Prevalence vs Survivorship
anova(Q2.flip, X=c(0,0,0,0,0,0,0,0,-1,0,0,1))
# Intensity vs Fecundity
anova(Q2.flip, X=c(0,0,0,0,0,0,0,0,0,-1,1,0))
# Intensity vs Survivorship
anova(Q2.flip, X=c(0,0,0,0,0,0,0,0,0,-1,0,1))
# Environment
# Prevalence vs Fecundity
anova(Q2.flip, X=c(-1,0,1,0,0,0,0,0,0,0,0,0))
# Prevalence vs Survivorship
anova(Q2.flip, X=c(-1,0,0,1,0,0,0,0,0,0,0,0))
# Intensity vs Fecundity
anova(Q2.flip, X=c(0,-1,1,0,0,0,0,0,0,0,0,0))
# Intensity vs Survivorship
anova(Q2.flip, X=c(0,-1,0,1,0,0,0,0,0,0,0,0))
# Pollution
# Prevalence vs Fecundity
anova(Q2.flip, X=c(0,0,0,0,-1,0,1,0,0,0,0,0))
# Prevalence vs Survivorship
anova(Q2.flip, X=c(0,0,0,0,-1,0,0,1,0,0,0,0))
# Intensity vs Fecundity
anova(Q2.flip, X=c(0,0,0,0,0,-1,1,0,0,0,0,0))
# Intensity vs Survivorship
anova(Q2.flip, X=c(0,0,0,0,0,-1,0,1,0,0,0,0))
# Resources
# Prevalence vs Fecundity
anova(Q2.flip, X=c(0,0,0,0,0,0,0,0,-1,0,1,0))
# Prevalence vs Survivorship
anova(Q2.flip, X=c(0,0,0,0,0,0,0,0,-1,0,0,1))
# Intensity vs Fecundity
anova(Q2.flip, X=c(0,0,0,0,0,0,0,0,0,-1,1,0))
# Intensity vs Survivorship
anova(Q2.flip, X=c(0,0,0,0,0,0,0,0,0,-1,0,1))
#absolute <- grep(pattern = "Fecundity|Survivorship|Intensity|Prevalence", x = dat_2$Trait.type)
#for(i in absolute){
#  dat_2$g[i] <- abs(dat_2$g[i])
#}
dat_2$absolute <- abs(dat_2$g)
Q2.abs <-
rma.mv(
absolute ~ Trait.type:Gradient.category -1,
V = varcovmat_2_PD$mat,
random = list(~ 1 | Experiment,  ~ 1 | ID),
data = dat_2,
method = "REML",
)
summary(Q2.abs)
forest.default(x= Q2.abs$beta, sei =  Q2.abs$se, ci.lb =  Q2.abs$ci.lb, ci.ub =  Q2.abs$ci.ub,
annotate=TRUE, showweights=T, header=F,
slab = c("EE:prevalence", "EE:intensity","EE:fecundity", "EE:survivorship",
"CP:prevalence", "CP:intensity","CP:fecundity", "CP:survivorship",
"RL:prevalence", "RL:intensity","RL:fecundity","RL:survivorship"))
# Environment
# Prevalence vs Fecundity
anova(Q2.abs, X=c(-1,0,1,0,0,0,0,0,0,0,0,0))
# Prevalence vs Survivorship
anova(Q2.abs, X=c(-1,0,0,1,0,0,0,0,0,0,0,0))
# Intensity vs Fecundity
anova(Q2.abs, X=c(0,-1,1,0,0,0,0,0,0,0,0,0))
# Intensity vs Survivorship
anova(Q2.abs, X=c(0,-1,0,1,0,0,0,0,0,0,0,0))
# Pollution
# Prevalence vs Fecundity
anova(Q2.abs, X=c(0,0,0,0,-1,0,1,0,0,0,0,0))
# Prevalence vs Survivorship
anova(Q2.abs, X=c(0,0,0,0,-1,0,0,1,0,0,0,0))
# Intensity vs Fecundity
anova(Q2.abs, X=c(0,0,0,0,0,-1,1,0,0,0,0,0))
# Intensity vs Survivorship
anova(Q2.abs, X=c(0,0,0,0,0,-1,0,1,0,0,0,0))
# Resources
# Prevalence vs Fecundity
anova(Q2.abs, X=c(0,0,0,0,0,0,0,0,-1,0,1,0))
# Prevalence vs Survivorship
anova(Q2.abs, X=c(0,0,0,0,0,0,0,0,-1,0,0,1))
# Intensity vs Fecundity
anova(Q2.abs, X=c(0,0,0,0,0,0,0,0,0,-1,1,0))
# Intensity vs Survivorship
anova(Q2.abs, X=c(0,0,0,0,0,0,0,0,0,-1,0,1))
# Intensity vs Survivorship
t.test(Q2.flip, X=c(0,0,0,0,0,0,0,0,0,-1,0,1))
Table3 <- data.frame(Stressor_type = rep(c("Endogenous environment",  "Chemical pollution","Resource limitation"), each = 4),
Response_trait = c(rep(c("Prevalence","Intensity","Fecundity", "Survivorship"), 3)),
Overall_mean = round(Q2$beta,3),
Lower_95 = round(Q2$ci.lb,3),
Upper_95 = round(Q2$ci.ub,3),
P_value = round(Q2$pval,3),
N_effects = c(length(dat_2$ID[dat_2$Gradient.category == "Environment" & dat_2$Trait.type == "Prevalence"]),
length(dat_2$ID[dat_2$Gradient.category == "Environment" & dat_2$Trait.type == "Intensity"]),
length(dat_2$ID[dat_2$Gradient.category == "Environment" & dat_2$Trait.type == "Fecundity"]),
length(dat_2$ID[dat_2$Gradient.category == "Environment" & dat_2$Trait.type == "Survivorship"]),
length(dat_2$ID[dat_2$Gradient.category == "Pollution" & dat_2$Trait.type == "Prevalence"]),
length(dat_2$ID[dat_2$Gradient.category == "Pollution" & dat_2$Trait.type == "Intensity"]),
length(dat_2$ID[dat_2$Gradient.category == "Pollution" & dat_2$Trait.type == "Fecundity"]),
length(dat_2$ID[dat_2$Gradient.category == "Pollution" & dat_2$Trait.type == "Survivorship"]),
length(dat_2$ID[dat_2$Gradient.category == "Resource" & dat_2$Trait.type == "Prevalence"]),
length(dat_2$ID[dat_2$Gradient.category == "Resource" & dat_2$Trait.type == "Intensity"]),
length(dat_2$ID[dat_2$Gradient.category == "Resource" & dat_2$Trait.type == "Fecundity"]),
length(dat_2$ID[dat_2$Gradient.category == "Resource" & dat_2$Trait.type == "Survivorship"])),
N_experiments = c(length(unique(dat_2$Experiment[dat_2$Gradient.category == "Environment" & dat_2$Trait.type == "Prevalence"])),
length(unique(dat_2$Experiment[dat_2$Gradient.category == "Environment" & dat_2$Trait.type == "Intensity"])),
length(unique(dat_2$Experiment[dat_2$Gradient.category == "Environment" & dat_2$Trait.type == "Fecundity"])),
length(unique(dat_2$Experiment[dat_2$Gradient.category == "Environment" & dat_2$Trait.type == "Survivorship"])),
length(unique(dat_2$Experiment[dat_2$Gradient.category == "Pollution" & dat_2$Trait.type == "Prevalence"])),
length(unique(dat_2$Experiment[dat_2$Gradient.category == "Pollution" & dat_2$Trait.type == "Intensity"])),
length(unique(dat_2$Experiment[dat_2$Gradient.category == "Pollution" & dat_2$Trait.type == "Fecundity"])),
length(unique(dat_2$Experiment[dat_2$Gradient.category == "Pollution" & dat_2$Trait.type == "Survivorship"])),
length(unique(dat_2$Experiment[dat_2$Gradient.category == "Resource" & dat_2$Trait.type == "Prevalence"])),
length(unique(dat_2$Experiment[dat_2$Gradient.category == "Resource" & dat_2$Trait.type == "Intensity"])),
length(unique(dat_2$Experiment[dat_2$Gradient.category == "Resource" & dat_2$Trait.type == "Fecundity"])),
length(unique(dat_2$Experiment[dat_2$Gradient.category == "Resource" & dat_2$Trait.type == "Survivorship"]))
),
N_host_taxa = c(length(unique(dat_2$Host[dat_2$Gradient.category == "Environment" & dat_2$Trait.type == "Prevalence"])),
length(unique(dat_2$Host[dat_2$Gradient.category == "Environment" & dat_2$Trait.type == "Intensity"])),
length(unique(dat_2$Host[dat_2$Gradient.category == "Environment" & dat_2$Trait.type == "Fecundity"])),
length(unique(dat_2$Host[dat_2$Gradient.category == "Environment" & dat_2$Trait.type == "Survivorship"])),
length(unique(dat_2$Host[dat_2$Gradient.category == "Pollution" & dat_2$Trait.type == "Prevalence"])),
length(unique(dat_2$Host[dat_2$Gradient.category == "Pollution" & dat_2$Trait.type == "Intensity"])),
length(unique(dat_2$Host[dat_2$Gradient.category == "Pollution" & dat_2$Trait.type == "Fecundity"])),
length(unique(dat_2$Host[dat_2$Gradient.category == "Pollution" & dat_2$Trait.type == "Survivorship"])),
length(unique(dat_2$Host[dat_2$Gradient.category == "Resource" & dat_2$Trait.type == "Prevalence"])),
length(unique(dat_2$Host[dat_2$Gradient.category == "Resource" & dat_2$Trait.type == "Intensity"])),
length(unique(dat_2$Host[dat_2$Gradient.category == "Resource" & dat_2$Trait.type == "Fecundity"])),
length(unique(dat_2$Host[dat_2$Gradient.category == "Resource" & dat_2$Trait.type == "Survivorship"]))
))
rownames(Table3) <- NULL
Table3 %>%
kbl() %>%
kable_material(c("striped", "hover"), full_width = F)
Q2.R <-
rma.mv(
g ~ Trait.type:Gradient.category -1,
V = dat_2$var.g,
random = list(~ 1 | Experiment,  ~ 1 | ID),
data = dat_2,
method = "REML",
)
Q2.R_est <- clubSandwich::coef_test(Q2.R, vcov = "CR2")
forest.default(x= Q2.R_est$beta, sei =  Q2.R_est$SE, pch = 19,
annotate=TRUE, showweights=F, header=c("Parameter", "Estimate [95% CI]"),
slab = c("EE:prevalence", "EE:intensity", "EE:fecundity", "EE:survivorship", "CP:prevalence", "CP:intensity", "CP:fecundity", "CP:survivorship", "RL:prevalence", "RL:intensity", "RL:fecundity", "RL:survivorship"),
xlab = "Standardised mean difference (Hedge's g)")
Q2.R_est <- clubSandwich::coef_test(Q2.R, vcov = "CR2")
forest.default(x= Q2.R_est$beta, sei =  Q2.R_est$SE, pch = 19,
annotate=TRUE, showweights=F, header=c("Parameter", "Estimate [95% CI]"),
slab = c("EE:prevalence", "EE:intensity", "EE:fecundity", "EE:survivorship", "CP:prevalence", "CP:intensity", "CP:fecundity", "CP:survivorship", "RL:prevalence", "RL:intensity", "RL:fecundity", "RL:survivorship"),
xlab = "Standardised mean difference (Hedge's g)")
forest.default(x= Q1.B$beta, sei =  Q1.B$se, pch = 19,
annotate=TRUE, showweights=F, header=c("Parameter", "Estimate [95% CI]"),
slab = c("variance", "EE:fecundity", "EE:survivorship", "CP:fecundity", "CP:survivorship", "RL:fecundity", "RL:survivorship"),
xlab = "Standardised mean difference (Hedge's g)")
forest.default(x= Q2.B$beta, sei =  Q2.B$se, pch = 19,
annotate=TRUE, showweights=F, header=c("Parameter", "Estimate [95% CI]"),
slab = c("variance","EE:prevalence", "EE:intensity", "EE:fecundity", "EE:survivorship", "CP:prevalence", "CP:intensity", "CP:fecundity", "CP:survivorship", "RL:prevalence", "RL:intensity", "RL:fecundity", "RL:survivorship"),
xlab = "Standardised mean difference (Hedge's g)")
TableS3 <- data.frame(question = rep(c("Q1", "Q2"), each =  2),
step = rep(c("Step 1", "Step 2"),2),
slope = c(round(d1s1$b[2],3), round(d1s2$b[2],3), round(d2s1$b[2],3), round(d2s2$b[2],3)),
se = c(round(d1s1$se[2],3), round(d1s2$se[2],3), round(d2s1$se[2],3), round(d2s2$se[2],3)),
pval =c(round(d1s1$pval[2],3), round(d1s2$pval[2],3), round(d2s1$pval[2],3), round(d2s2$pval[2],3)))
TableS3 %>%
kbl() %>%
kable_material(c("striped", "hover"), full_width = F)
kbl() %>%
TableS4 %>%
kbl() %>%
kable_material(c("striped", "hover"), full_width = T)
