kable_material(c("striped", "hover"), full_width = F)
studies_3 <- unique(dat_3$Study)
studies_to_check <- c()
negative_eigen <- c()
for (k in studies_3) {
dat_study <- dat_2[which(dat_3$Study == k),]
varcovmat = matrix(0,
nrow = dim(dat_study)[1],
ncol = dim(dat_study)[1])
for (i in 1:dim(dat_study)[1]) {
for (j in 1:dim(dat_study)[1]) {
if (i == j) {
varcovmat[i, j] = dat_study$var.g[i]
} else{
if (dat_study[i, "Experiment"] == dat_study[j, "Experiment"] &
dat_study[i, "Level_C"] == dat_study[j, "Level_C"] &
dat_study[i, "Trait"] == dat_study[j, "Trait"] &
dat_study[i, "Trait.category"] == dat_study[j, "Trait.category"]) {
varcovmat[i, j] = 1 / dat_study[i, "N_C"] + dat_study$g[i] * dat_study$g[j] /
(dat_study[i, "N_C"] + dat_study[i, "N_X"] + dat_study[j, "N_X"])
}
}
}
}
val <- eigen(varcovmat)
for (m in 1:length(val$values)) {
if (val$values[m] < 0) {
studies_to_check <- append(studies_to_check, k)
negative_eigen <- append(negative_eigen, val$values[m])
}
}
}
studies_3 <- unique(dat_3$Study)
studies_to_check <- c()
negative_eigen <- c()
for (k in studies_3) {
dat_study <- dat_3[which(dat_3$Study == k),]
varcovmat = matrix(0,
nrow = dim(dat_study)[1],
ncol = dim(dat_study)[1])
for (i in 1:dim(dat_study)[1]) {
for (j in 1:dim(dat_study)[1]) {
if (i == j) {
varcovmat[i, j] = dat_study$var.g[i]
} else{
if (dat_study[i, "Experiment"] == dat_study[j, "Experiment"] &
dat_study[i, "Level_C"] == dat_study[j, "Level_C"] &
dat_study[i, "Trait"] == dat_study[j, "Trait"] &
dat_study[i, "Trait.category"] == dat_study[j, "Trait.category"]) {
varcovmat[i, j] = 1 / dat_study[i, "N_C"] + dat_study$g[i] * dat_study$g[j] /
(dat_study[i, "N_C"] + dat_study[i, "N_X"] + dat_study[j, "N_X"])
}
}
}
}
val <- eigen(varcovmat)
for (m in 1:length(val$values)) {
if (val$values[m] < 0) {
studies_to_check <- append(studies_to_check, k)
negative_eigen <- append(negative_eigen, val$values[m])
}
}
}
Neg_eigen_3 <- data.frame(study = studies_to_check, eigen = negative_eigen)
Neg_eigen_3 %>%
kbl() %>%
kable_material(c("striped", "hover"), full_width = F)
studies_2 <- unique(dat_2$Study)
studies_to_check <- c()
negative_eigen <- c()
for (k in studies_2) {
dat_study <- dat_2[which(dat_2$Study == k),]
varcovmat = matrix(0,
nrow = dim(dat_study)[1],
ncol = dim(dat_study)[1])
for (i in 1:dim(dat_study)[1]) {
for (j in 1:dim(dat_study)[1]) {
if (i == j) {
varcovmat[i, j] = dat_study$var.g[i]
} else{
if (dat_study[i, "Experiment"] == dat_study[j, "Experiment"] &
dat_study[i, "Level_C"] == dat_study[j, "Level_C"] &
dat_study[i, "Trait"] == dat_study[j, "Trait"] &
dat_study[i, "Trait.category"] == dat_study[j, "Trait.category"]) {
varcovmat[i, j] = 1 / dat_study[i, "N_C"] + dat_study$g[i] * dat_study$g[j] /
(dat_study[i, "N_C"] + dat_study[i, "N_X"] + dat_study[j, "N_X"])
}
}
}
}
val <- eigen(varcovmat)
for (m in 1:length(val$values)) {
if (val$values[m] < 0) {
studies_to_check <- append(studies_to_check, k)
negative_eigen <- append(negative_eigen, val$values[m])
}
}
}
Neg_eigen_2 <- data.frame(study = studies_to_check, eigen = negative_eigen)
Neg_eigen_2 %>%
kbl() %>%
kable_material(c("striped", "hover"), full_width = F)
# exclude suspicious studies with highly negative eigenvalues
dat_1 <- dat_1[-grep("Ashraf et al. 2017 Environ Sci Pollut Res", dat_1$Study),]
dat_1 <- dat_1[-grep("Shostak et al. 2015. Journal of Parasitology", dat_1$Study),]
dat_1 <- dat_1[-grep(121, dat_1$Experiment),]
varcovmat_1 = matrix(0, nrow = dim(dat_1)[1], ncol = dim(dat_1)[1])
for (i in 1:dim(dat_1)[1]) {
for (j in 1:dim(dat_1)[1]) {
if (i == j) {varcovmat_1[i,j] = dat_1$var.g[i]}else{
if (dat_1[i, "Experiment"] == dat_1[j, "Experiment"] & dat_1[i, "Level_C"] == dat_1[j, "Level_C"] & dat_1[i, "Trait"] == dat_1[j, "Trait"] & dat_1[i, "Trait.category"] == dat_1[j, "Trait.category"]) {
varcovmat_1[i,j] = 1/dat_1[i,"N_C"] + dat_1$g[i]*dat_1$g[j]/(dat_1[i,"N_C"] + dat_1[i,"N_X"] + dat_1[j,"N_X"])
}
}
}
}
# correct negative eigens in the few studies with large covar to var ratios
varcovmat_1_PD <- nearPD(varcovmat_1,  keepDiag = TRUE)
# exclude suspicious studies with highly negative eigenvalues
dat_2 <- dat_2[-grep("Ashraf et al. 2017 Environ Sci Pollut Res", dat_2$Study),]
varcovmat_2 = matrix(0, nrow = dim(dat_2)[1], ncol = dim(dat_2)[1])
for (i in 1:dim(dat_2)[1]) {
for (j in 1:dim(dat_2)[1]) {
if (i == j) {varcovmat_2[i,j] = dat_2$var.g[i]}else{
if (dat_2[i, "Experiment"] == dat_2[j, "Experiment"] & dat_2[i, "Level_C"] == dat_2[j, "Level_C"] & dat_2[i, "Trait"] == dat_2[j, "Trait"] & dat_2[i, "Trait.category"] == dat_2[j, "Trait.category"]) {
varcovmat_2[i,j] = 1/dat_2[i,"N_C"] + dat_2$g[i]*dat_2$g[j]/(dat_2[i,"N_C"] + dat_2[i,"N_X"] + dat_2[j,"N_X"])
}
}
}
}
# correct negative eigens in the few studies with large covar to var ratios
varcovmat_2_PD <- nearPD(varcovmat_2,  keepDiag = TRUE)
# exclude suspicious studies with highly negative eigenvalues
dat_3 <- dat_3[-grep("Ashraf et al. 2017 Environ Sci Pollut Res", dat_3$Study),]
# Carrington et al. 2013 has extremely large sampling variance for a parasite prevalence effect. DOUBLE CHECK!!!
dat_3 <- dat_3[-grep("Carrington et al. 2013. PLOS NegTropDiseases", dat_3$Study),]
varcovmat_3 = matrix(0, nrow = dim(dat_3)[1], ncol = dim(dat_3)[1])
for (i in 1:dim(dat_3)[1]) {
for (j in 1:dim(dat_3)[1]) {
if (i == j) {varcovmat_3[i,j] = dat_3$var.g[i]}else{
if (dat_3[i, "Experiment"] == dat_3[j, "Experiment"] & dat_3[i, "Level_C"] == dat_3[j, "Level_C"] & dat_3[i, "Trait"] == dat_3[j, "Trait"] & dat_3[i, "Trait.category"] == dat_3[j, "Trait.category"]) {
varcovmat_3[i,j] = 1/dat_3[i,"N_C"] + dat_3$g[i]*dat_3$g[j]/(dat_3[i,"N_C"] + dat_3[i,"N_X"] + dat_3[j,"N_X"])
}
}
}
}
# correct eigenvalues in the few studies with large covar to var ratios
varcovmat_3_PD <- nearPD(varcovmat_3, keepDiag = TRUE)
# For now remove rare host types to check interaction with host
dat_3_byHost <- dat_3[which(dat_3$Host.type == "Arthropod" | dat_3$Host.type == "Mollusc" | dat_3$Host.type == "Fish" | dat_3$Host.type == "Amphibian"), ]
varcovmat_3_byHost = matrix(0, nrow = dim(dat_3_byHost)[1], ncol = dim(dat_3_byHost)[1])
for (i in 1:dim(dat_3_byHost)[1]) {
for (j in 1:dim(dat_3_byHost)[1]) {
if (i == j) {varcovmat_3_byHost[i,j] = dat_3_byHost$var.g[i]}else{
if (dat_3_byHost[i, "Experiment"] == dat_3_byHost[j, "Experiment"] & dat_3_byHost[i, "Level_C"] == dat_3_byHost[j, "Level_C"] & dat_3_byHost[i, "Trait"] == dat_3_byHost[j, "Trait"] & dat_3_byHost[i, "Trait.category"] == dat_3_byHost[j, "Trait.category"]) {
varcovmat_3_byHost[i,j] = 1/dat_3_byHost[i,"N_C"] + dat_3_byHost$g[i]*dat_3_byHost$g[j]/(dat_3_byHost[i,"N_C"] + dat_3_byHost[i,"N_X"] + dat_3_byHost[j,"N_X"])
}
}
}
}
# correct eigenvalues in the few studies with large covar to var ratios
varcovmat_3_byHost_PD <- nearPD(varcovmat_3_byHost,  keepDiag = TRUE)
d_stats <-
data.frame(
stat = c(
"Number of papers",
"Number of effects",
"Number of experiments",
"Number of arthropod species",
"Number of mollusc species",
"Number of fish species",
"Number of amphibian species",
"Number of reptile species",
"Number of bird species",
"Number of mammal species",
"Number of viral taxa",
"Number of bacterial taxa",
"Number of Multiple infection",
"Number of fungal taxa",
"Number of protozan taxa",
"Number of helminth taxa",
"Number of environment experiments",
"Number of pollution experiments",
"Number of resource experiments",
"Number of resistance effects",
"Number of prevalence effects",
"Number of intensity effects",
"Number of tolerance effects",
"Number of survival effects",
"Number of fecundity effects"
),
Question_1 = c(
length(unique(dat_1$Study)),
length(dat_1$g),
length(unique(dat_1$Experiment)),
length(unique(dat_1$Host[which(dat_1$Host.type == "Arthropod")])),
length(unique(dat_1$Host[which(dat_1$Host.type == "Mollusc")])),
length(unique(dat_1$Host[which(dat_1$Host.type == "Fish")])),
length(unique(dat_1$Host[which(dat_1$Host.type == "Amphibian")])),
length(unique(dat_1$Host[which(dat_1$Host.type == "Reptile")])),
length(unique(dat_1$Host[which(dat_1$Host.type == "Bird")])),
length(unique(dat_1$Host[which(dat_1$Host.type == "Mammal")])),
length(unique(dat_1$Parasite[which(dat_1$Parasite.type ==
"Virus")])),
length(unique(dat_1$Parasite[which(dat_1$Parasite.type ==
"Bacteria")])),
length(unique(dat_1$Parasite[which(dat_1$Parasite.type ==
"Multiple")])),
length(unique(dat_1$Parasite[which(dat_1$Parasite.type ==
"Fungus")])),
length(unique(dat_1$Parasite[which(dat_1$Parasite.type ==
"Protozoan")])),
length(unique(dat_1$Parasite[which(dat_1$Parasite.type ==
"Helminth")])),
length(dat_1$Experiment[which(dat_1$Gradient.category ==
"Environment")]),
length(dat_1$Experiment[which(dat_1$Gradient.category ==
"Pollution")]),
length(dat_1$Experiment[which(dat_1$Gradient.category ==
"Resource")]),
length(dat_1$ID[which(dat_1$Trait.category == "Epidemiological")]),
length(dat_1$ID[which(dat_1$Trait.type == "Prevalence")]),
length(dat_1$ID[which(dat_1$Trait.type == "Intensity")]),
length(dat_1$ID[grep("demographic", dat_1$Trait.category)]),
length(dat_1$ID[which(dat_1$Trait.type == "Survivorship")]),
length(dat_1$ID[which(dat_1$Trait.type == "Fecundity")])
),
Question_2 = c(
length(unique(dat_2$Study)),
length(dat_2$g),
length(unique(dat_2$Experiment)),
length(unique(dat_2$Host[which(dat_2$Host.type == "Arthropod")])),
length(unique(dat_2$Host[which(dat_2$Host.type == "Mollusc")])),
length(unique(dat_2$Host[which(dat_2$Host.type == "Fish")])),
length(unique(dat_2$Host[which(dat_2$Host.type == "Amphibian")])),
length(unique(dat_2$Host[which(dat_2$Host.type == "Reptile")])),
length(unique(dat_2$Host[which(dat_2$Host.type == "Bird")])),
length(unique(dat_2$Host[which(dat_2$Host.type == "Mammal")])),
length(unique(dat_2$Parasite[which(dat_2$Parasite.type ==
"Virus")])),
length(unique(dat_2$Parasite[which(dat_2$Parasite.type ==
"Bacteria")])),
length(unique(dat_2$Parasite[which(dat_2$Parasite.type ==
"Multiple")])),
length(unique(dat_2$Parasite[which(dat_2$Parasite.type ==
"Fungus")])),
length(unique(dat_2$Parasite[which(dat_2$Parasite.type ==
"Protozoan")])),
length(unique(dat_2$Parasite[which(dat_2$Parasite.type ==
"Helminth")])),
length(dat_2$Experiment[which(dat_2$Gradient.category ==
"Environment")]),
length(dat_2$Experiment[which(dat_2$Gradient.category ==
"Pollution")]),
length(dat_2$Experiment[which(dat_2$Gradient.category ==
"Resource")]),
length(dat_2$ID[which(dat_2$Trait.category == "Epidemiological")]),
length(dat_2$ID[which(dat_2$Trait.type == "Prevalence")]),
length(dat_2$ID[which(dat_2$Trait.type == "Intensity")]),
length(dat_2$ID[grep("demographic", dat_2$Trait.category)]),
length(dat_2$ID[which(dat_2$Trait.type == "Survivorship")]),
length(dat_2$ID[which(dat_2$Trait.type == "Fecundity")])
),
Question_3 = c(
length(unique(dat_3$Study)),
length(dat_3$g),
length(unique(dat_3$Experiment)),
length(unique(dat_3$Host[which(dat_3$Host.type == "Arthropod")])),
length(unique(dat_3$Host[which(dat_3$Host.type == "Mollusc")])),
length(unique(dat_3$Host[which(dat_3$Host.type == "Fish")])),
length(unique(dat_3$Host[which(dat_3$Host.type == "Amphibian")])),
length(unique(dat_3$Host[which(dat_3$Host.type == "Reptile")])),
length(unique(dat_3$Host[which(dat_3$Host.type == "Bird")])),
length(unique(dat_3$Host[which(dat_3$Host.type == "Mammal")])),
length(unique(dat_3$Parasite[which(dat_3$Parasite.type ==
"Virus")])),
length(unique(dat_3$Parasite[which(dat_3$Parasite.type ==
"Bacteria")])),
length(unique(dat_3$Parasite[which(dat_3$Parasite.type ==
"Multiple")])),
length(unique(dat_3$Parasite[which(dat_3$Parasite.type ==
"Fungus")])),
length(unique(dat_3$Parasite[which(dat_3$Parasite.type ==
"Protozoan")])),
length(unique(dat_3$Parasite[which(dat_3$Parasite.type ==
"Helminth")])),
length(dat_3$Experiment[which(dat_3$Gradient.category ==
"Environment")]),
length(dat_3$Experiment[which(dat_3$Gradient.category ==
"Pollution")]),
length(dat_3$Experiment[which(dat_3$Gradient.category ==
"Resource")]),
length(dat_3$ID[which(dat_3$Trait.category == "Epidemiological")]),
length(dat_3$ID[which(dat_3$Trait.type == "Prevalence")]),
length(dat_3$ID[which(dat_3$Trait.type == "Intensity")]),
length(dat_3$ID[grep("demographic", dat_3$Trait.category)]),
length(dat_3$ID[which(dat_3$Trait.type == "Survivorship")]),
length(dat_3$ID[which(dat_3$Trait.type == "Fecundity")])
)
)
d_stats %>%
kbl() %>%
kable_material(c("striped", "hover"), full_width = F)
d_stats <-
data.frame(
stat = c(
"Number of papers",
"Number of effects",
"Number of experiments",
"Number of arthropod species",
"Number of mollusc species",
"Number of fish species",
"Number of amphibian species",
"Number of reptile species",
"Number of bird species",
"Number of mammal species",
"Number of viral taxa",
"Number of bacterial taxa",
"Number of Multiple infection",
"Number of fungal taxa",
"Number of protozan taxa",
"Number of helminth taxa",
"Number of environment experiments",
"Number of pollution experiments",
"Number of resource experiments",
"Number of resistance effects",
"Number of prevalence effects",
"Number of intensity effects",
"Number of fitness effects",
"Number of survival effects",
"Number of fecundity effects"
),
Question_1 = c(
length(unique(dat_1$Study)),
length(dat_1$g),
length(unique(dat_1$Experiment)),
length(unique(dat_1$Host[which(dat_1$Host.type == "Arthropod")])),
length(unique(dat_1$Host[which(dat_1$Host.type == "Mollusc")])),
length(unique(dat_1$Host[which(dat_1$Host.type == "Fish")])),
length(unique(dat_1$Host[which(dat_1$Host.type == "Amphibian")])),
length(unique(dat_1$Host[which(dat_1$Host.type == "Reptile")])),
length(unique(dat_1$Host[which(dat_1$Host.type == "Bird")])),
length(unique(dat_1$Host[which(dat_1$Host.type == "Mammal")])),
length(unique(dat_1$Parasite[which(dat_1$Parasite.type ==
"Virus")])),
length(unique(dat_1$Parasite[which(dat_1$Parasite.type ==
"Bacteria")])),
length(unique(dat_1$Parasite[which(dat_1$Parasite.type ==
"Multiple")])),
length(unique(dat_1$Parasite[which(dat_1$Parasite.type ==
"Fungus")])),
length(unique(dat_1$Parasite[which(dat_1$Parasite.type ==
"Protozoan")])),
length(unique(dat_1$Parasite[which(dat_1$Parasite.type ==
"Helminth")])),
length(dat_1$Experiment[which(dat_1$Gradient.category ==
"Environment")]),
length(dat_1$Experiment[which(dat_1$Gradient.category ==
"Pollution")]),
length(dat_1$Experiment[which(dat_1$Gradient.category ==
"Resource")]),
length(dat_1$ID[which(dat_1$Trait.category == "Epidemiological")]),
length(dat_1$ID[which(dat_1$Trait.type == "Prevalence")]),
length(dat_1$ID[which(dat_1$Trait.type == "Intensity")]),
length(dat_1$ID[grep("demographic", dat_1$Trait.category)]),
length(dat_1$ID[which(dat_1$Trait.type == "Survivorship")]),
length(dat_1$ID[which(dat_1$Trait.type == "Fecundity")])
),
Question_2 = c(
length(unique(dat_2$Study)),
length(dat_2$g),
length(unique(dat_2$Experiment)),
length(unique(dat_2$Host[which(dat_2$Host.type == "Arthropod")])),
length(unique(dat_2$Host[which(dat_2$Host.type == "Mollusc")])),
length(unique(dat_2$Host[which(dat_2$Host.type == "Fish")])),
length(unique(dat_2$Host[which(dat_2$Host.type == "Amphibian")])),
length(unique(dat_2$Host[which(dat_2$Host.type == "Reptile")])),
length(unique(dat_2$Host[which(dat_2$Host.type == "Bird")])),
length(unique(dat_2$Host[which(dat_2$Host.type == "Mammal")])),
length(unique(dat_2$Parasite[which(dat_2$Parasite.type ==
"Virus")])),
length(unique(dat_2$Parasite[which(dat_2$Parasite.type ==
"Bacteria")])),
length(unique(dat_2$Parasite[which(dat_2$Parasite.type ==
"Multiple")])),
length(unique(dat_2$Parasite[which(dat_2$Parasite.type ==
"Fungus")])),
length(unique(dat_2$Parasite[which(dat_2$Parasite.type ==
"Protozoan")])),
length(unique(dat_2$Parasite[which(dat_2$Parasite.type ==
"Helminth")])),
length(dat_2$Experiment[which(dat_2$Gradient.category ==
"Environment")]),
length(dat_2$Experiment[which(dat_2$Gradient.category ==
"Pollution")]),
length(dat_2$Experiment[which(dat_2$Gradient.category ==
"Resource")]),
length(dat_2$ID[which(dat_2$Trait.category == "Epidemiological")]),
length(dat_2$ID[which(dat_2$Trait.type == "Prevalence")]),
length(dat_2$ID[which(dat_2$Trait.type == "Intensity")]),
length(dat_2$ID[grep("demographic", dat_2$Trait.category)]),
length(dat_2$ID[which(dat_2$Trait.type == "Survivorship")]),
length(dat_2$ID[which(dat_2$Trait.type == "Fecundity")])
),
Question_3 = c(
length(unique(dat_3$Study)),
length(dat_3$g),
length(unique(dat_3$Experiment)),
length(unique(dat_3$Host[which(dat_3$Host.type == "Arthropod")])),
length(unique(dat_3$Host[which(dat_3$Host.type == "Mollusc")])),
length(unique(dat_3$Host[which(dat_3$Host.type == "Fish")])),
length(unique(dat_3$Host[which(dat_3$Host.type == "Amphibian")])),
length(unique(dat_3$Host[which(dat_3$Host.type == "Reptile")])),
length(unique(dat_3$Host[which(dat_3$Host.type == "Bird")])),
length(unique(dat_3$Host[which(dat_3$Host.type == "Mammal")])),
length(unique(dat_3$Parasite[which(dat_3$Parasite.type ==
"Virus")])),
length(unique(dat_3$Parasite[which(dat_3$Parasite.type ==
"Bacteria")])),
length(unique(dat_3$Parasite[which(dat_3$Parasite.type ==
"Multiple")])),
length(unique(dat_3$Parasite[which(dat_3$Parasite.type ==
"Fungus")])),
length(unique(dat_3$Parasite[which(dat_3$Parasite.type ==
"Protozoan")])),
length(unique(dat_3$Parasite[which(dat_3$Parasite.type ==
"Helminth")])),
length(dat_3$Experiment[which(dat_3$Gradient.category ==
"Environment")]),
length(dat_3$Experiment[which(dat_3$Gradient.category ==
"Pollution")]),
length(dat_3$Experiment[which(dat_3$Gradient.category ==
"Resource")]),
length(dat_3$ID[which(dat_3$Trait.category == "Epidemiological")]),
length(dat_3$ID[which(dat_3$Trait.type == "Prevalence")]),
length(dat_3$ID[which(dat_3$Trait.type == "Intensity")]),
length(dat_3$ID[grep("demographic", dat_3$Trait.category)]),
length(dat_3$ID[which(dat_3$Trait.type == "Survivorship")]),
length(dat_3$ID[which(dat_3$Trait.type == "Fecundity")])
)
)
d_stats %>%
kbl() %>%
kable_material(c("striped", "hover"), full_width = F)
View(dat_2)
View(dat_2)
Q2m1 <-
rma.mv(
abs(g) ~ 1,
V = varcovmat_2_PD$mat,
random = list( ~ 1 | as.factor(ID), ~ 1 | as.factor(Experiment), ~ 1 | Parasite),
data = dat_2,
method = "REML"
)
summary(Q2m1)
Q2m2 <-
rma.mv(
abs(g) ~ Trait.category * Trait.type ,
V = varcovmat_2_PD$mat,
random = list( ~ 1 | as.factor(ID), ~ 1 | as.factor(Experiment), ~ 1 | Parasite),
data = dat_2,
method = "REML"
)
Q2m2 <-
rma.mv(
abs(g) ~ Trait.type ,
V = varcovmat_2_PD$mat,
random = list( ~ 1 | as.factor(ID), ~ 1 | as.factor(Experiment), ~ 1 | Parasite),
data = dat_2,
method = "REML"
)
summary(Q2m2)
summary(Q2m2)
Q2m2 <-
rma.mv(
g ~ Trait.type ,
V = varcovmat_2_PD$mat,
random = list( ~ 1 | as.factor(ID), ~ 1 | as.factor(Experiment), ~ 1 | Parasite),
data = dat_2,
method = "REML"
)
summary(Q2m2)
summary(Q2m2)
Q2m2 <-
rma.mv(
abs(g) ~ Trait.type ,
V = varcovmat_2_PD$mat,
random = list( ~ 1 | as.factor(ID), ~ 1 | as.factor(Experiment), ~ 1 | Parasite),
data = dat_2,
method = "REML"
)
summary(Q2m2)
Q2m3 <-
rma.mv(
abs(g) ~ Trait.type : Gradient.category -1,
V = varcovmat_2_PD$mat,
random = list( ~ 1 |
as.factor(ID), ~ 1 | as.factor(Experiment), ~ 1 | Parasite),
data = dat_2,
method = "REML"
)
summary(Q2m3)
Q2m4 <-
rma.mv(
abs(g) ~ Trait.type*Gradient.category ,
V = varcovmat_2_PD$mat,
random = list( ~ 1 |
as.factor(ID), ~ 1 | as.factor(Experiment), ~ 1 | Parasite),
data = dat_2,
method = "REML"
)
summary(Q2m4)
