}
Neg_eigen_2 <- data.frame(study = studies_to_check, eigen = negative_eigen)
Neg_eigen_2 %>%
kbl() %>%
kable_material(c("striped", "hover"), full_width = F)
studies_3 <- unique(dat_3$Study)
studies_to_check <- c()
negative_eigen <- c()
for (k in studies_3) {
dat_study <- dat_3[which(dat_3$Study == k),]
varcovmat = matrix(0,
nrow = dim(dat_study)[1],
ncol = dim(dat_study)[1])
for (i in 1:dim(dat_study)[1]) {
for (j in 1:dim(dat_study)[1]) {
if (i == j) {
varcovmat[i, j] = dat_study$var.g[i]
} else{
if (dat_study[i, "Experiment"] == dat_study[j, "Experiment"] &
dat_study[i, "Level_C"] == dat_study[j, "Level_C"] &
dat_study[i, "Trait"] == dat_study[j, "Trait"] &
dat_study[i, "Trait.category"] == dat_study[j, "Trait.category"]) {
varcovmat[i, j] = 1 / dat_study[i, "N_C"] + dat_study$g[i] * dat_study$g[j] /
(dat_study[i, "N_C"] + dat_study[i, "N_X"] + dat_study[j, "N_X"])
}
}
}
}
val <- eigen(varcovmat)
for (m in 1:length(val$values)) {
if (val$values[m] < 0) {
studies_to_check <- append(studies_to_check, k)
negative_eigen <- append(negative_eigen, val$values[m])
}
}
}
Neg_eigen_3 <- data.frame(study = studies_to_check, eigen = negative_eigen)
Neg_eigen_3 %>%
kbl() %>%
kable_material(c("striped", "hover"), full_width = F)
# exclude suspicious studies with highly negative eigenvalues
dat_1 <- dat_1[-grep("Ashraf et al. 2017 Environ Sci Pollut Res", dat_1$Study),]
dat_1 <- dat_1[-grep("Shostak et al. 2015. Journal of Parasitology", dat_1$Study),]
dat_1 <- dat_1[-grep(121, dat_1$Experiment),]
varcovmat_1 = matrix(0, nrow = dim(dat_1)[1], ncol = dim(dat_1)[1])
for (i in 1:dim(dat_1)[1]) {
for (j in 1:dim(dat_1)[1]) {
if (i == j) {varcovmat_1[i,j] = dat_1$var.g[i]}else{
if (dat_1[i, "Experiment"] == dat_1[j, "Experiment"] & dat_1[i, "Level_C"] == dat_1[j, "Level_C"] & dat_1[i, "Trait"] == dat_1[j, "Trait"] & dat_1[i, "Trait.category"] == dat_1[j, "Trait.category"]) {
varcovmat_1[i,j] = 1/dat_1[i,"N_C"] + dat_1$g[i]*dat_1$g[j]/(dat_1[i,"N_C"] + dat_1[i,"N_X"] + dat_1[j,"N_X"])
}
}
}
}
# correct negative eigens in the few studies with large covar to var ratios
varcovmat_1_PD <- nearPD(varcovmat_1,  keepDiag = TRUE)
# exclude suspicious studies with highly negative eigenvalues
dat_2 <- dat_2[-grep("Ashraf et al. 2017 Environ Sci Pollut Res", dat_2$Study),]
varcovmat_2 = matrix(0, nrow = dim(dat_2)[1], ncol = dim(dat_2)[1])
for (i in 1:dim(dat_2)[1]) {
for (j in 1:dim(dat_2)[1]) {
if (i == j) {varcovmat_2[i,j] = dat_2$var.g[i]}else{
if (dat_2[i, "Experiment"] == dat_2[j, "Experiment"] & dat_2[i, "Level_C"] == dat_2[j, "Level_C"] & dat_2[i, "Trait"] == dat_2[j, "Trait"] & dat_2[i, "Trait.category"] == dat_2[j, "Trait.category"]) {
varcovmat_2[i,j] = 1/dat_2[i,"N_C"] + dat_2$g[i]*dat_2$g[j]/(dat_2[i,"N_C"] + dat_2[i,"N_X"] + dat_2[j,"N_X"])
}
}
}
}
# correct negative eigens in the few studies with large covar to var ratios
varcovmat_2_PD <- nearPD(varcovmat_2,  keepDiag = TRUE)
# exclude suspicious studies with highly negative eigenvalues
dat_3 <- dat_3[-grep("Ashraf et al. 2017 Environ Sci Pollut Res", dat_3$Study),]
# Carrington et al. 2013 has extremely large sampling variance for a parasite prevalence effect. DOUBLE CHECK!!!
dat_3 <- dat_3[-grep("Carrington et al. 2013. PLOS NegTropDiseases", dat_3$Study),]
varcovmat_3 = matrix(0, nrow = dim(dat_3)[1], ncol = dim(dat_3)[1])
for (i in 1:dim(dat_3)[1]) {
for (j in 1:dim(dat_3)[1]) {
if (i == j) {varcovmat_3[i,j] = dat_3$var.g[i]}else{
if (dat_3[i, "Experiment"] == dat_3[j, "Experiment"] & dat_3[i, "Level_C"] == dat_3[j, "Level_C"] & dat_3[i, "Trait"] == dat_3[j, "Trait"] & dat_3[i, "Trait.category"] == dat_3[j, "Trait.category"]) {
varcovmat_3[i,j] = 1/dat_3[i,"N_C"] + dat_3$g[i]*dat_3$g[j]/(dat_3[i,"N_C"] + dat_3[i,"N_X"] + dat_3[j,"N_X"])
}
}
}
}
# correct eigenvalues in the few studies with large covar to var ratios
varcovmat_3_PD <- nearPD(varcovmat_3, keepDiag = TRUE)
# For now remove rare host types to check interaction with host
dat_3_byHost <- dat_3[which(dat_3$Host.type == "Arthropod" | dat_3$Host.type == "Mollusc" | dat_3$Host.type == "Fish" | dat_3$Host.type == "Amphibian"), ]
varcovmat_3_byHost = matrix(0, nrow = dim(dat_3_byHost)[1], ncol = dim(dat_3_byHost)[1])
for (i in 1:dim(dat_3_byHost)[1]) {
for (j in 1:dim(dat_3_byHost)[1]) {
if (i == j) {varcovmat_3_byHost[i,j] = dat_3_byHost$var.g[i]}else{
if (dat_3_byHost[i, "Experiment"] == dat_3_byHost[j, "Experiment"] & dat_3_byHost[i, "Level_C"] == dat_3_byHost[j, "Level_C"] & dat_3_byHost[i, "Trait"] == dat_3_byHost[j, "Trait"] & dat_3_byHost[i, "Trait.category"] == dat_3_byHost[j, "Trait.category"]) {
varcovmat_3_byHost[i,j] = 1/dat_3_byHost[i,"N_C"] + dat_3_byHost$g[i]*dat_3_byHost$g[j]/(dat_3_byHost[i,"N_C"] + dat_3_byHost[i,"N_X"] + dat_3_byHost[j,"N_X"])
}
}
}
}
# correct eigenvalues in the few studies with large covar to var ratios
varcovmat_3_byHost_PD <- nearPD(varcovmat_3_byHost,  keepDiag = TRUE)
dat_1 <- mutate(dat_1, Host.type.2 = case_when(
Host.type == "Fish" ~ "Vertebrate",
Host.type == "Arthropod" ~ "Invertebrate",
Host.type == "Amphibian" ~ "Vertebrate",
Host.type == "Mollusc" ~ "Invertebrate"))
dat_2 <- mutate(dat_2, Host.type.2 = case_when(
Host.type == "Fish" ~ "Vertebrate",
Host.type == "Arthropod" ~ "Invertebrate",
Host.type == "Amphibian" ~ "Vertebrate",
Host.type == "Mollusc" ~ "Invertebrate",
Host.type == "Reptile" ~ "Vertebrate",
Host.type == "Bird" ~ "Vertebrate",
Host.type == "Mammal" ~ "Vertebrate"))
dat_3 <- mutate(dat_3, Host.type.2 = case_when(
Host.type == "Fish" ~ "Vertebrate",
Host.type == "Arthropod" ~ "Invertebrate",
Host.type == "Amphibian" ~ "Vertebrate",
Host.type == "Mollusc" ~ "Invertebrate",
Host.type == "Reptile" ~ "Vertebrate",
Host.type == "Bird" ~ "Vertebrate",
Host.type == "Mammal" ~ "Vertebrate"))
d_stats <-
data.frame(
stat = c(
"Number of papers",
"Number of effects",
"Number of experiments",
"Number of arthropod species",
"Number of mollusc species",
"Number of fish species",
"Number of amphibian species",
"Number of reptile species",
"Number of bird species",
"Number of mammal species",
"Number of viral taxa",
"Number of bacterial taxa",
"Number of Multiple infection",
"Number of fungal taxa",
"Number of protozan taxa",
"Number of helminth taxa",
"Number of environment experiments",
"Number of pollution experiments",
"Number of resource experiments",
"Number of resistance effects",
"Number of prevalence effects",
"Number of intensity effects",
"Number of fitness effects",
"Number of survival effects",
"Number of fecundity effects"
),
Question_1 = c(
length(unique(dat_1$Study)),
length(dat_1$g),
length(unique(dat_1$Experiment)),
length(unique(dat_1$Host[which(dat_1$Host.type == "Arthropod")])),
length(unique(dat_1$Host[which(dat_1$Host.type == "Mollusc")])),
length(unique(dat_1$Host[which(dat_1$Host.type == "Fish")])),
length(unique(dat_1$Host[which(dat_1$Host.type == "Amphibian")])),
length(unique(dat_1$Host[which(dat_1$Host.type == "Reptile")])),
length(unique(dat_1$Host[which(dat_1$Host.type == "Bird")])),
length(unique(dat_1$Host[which(dat_1$Host.type == "Mammal")])),
length(unique(dat_1$Parasite[which(dat_1$Parasite.type ==
"Virus")])),
length(unique(dat_1$Parasite[which(dat_1$Parasite.type ==
"Bacteria")])),
length(unique(dat_1$Parasite[which(dat_1$Parasite.type ==
"Multiple")])),
length(unique(dat_1$Parasite[which(dat_1$Parasite.type ==
"Fungus")])),
length(unique(dat_1$Parasite[which(dat_1$Parasite.type ==
"Protozoan")])),
length(unique(dat_1$Parasite[which(dat_1$Parasite.type ==
"Helminth")])),
length(dat_1$Experiment[which(dat_1$Gradient.category ==
"Environment")]),
length(dat_1$Experiment[which(dat_1$Gradient.category ==
"Pollution")]),
length(dat_1$Experiment[which(dat_1$Gradient.category ==
"Resource")]),
length(dat_1$ID[which(dat_1$Trait.category == "Epidemiological")]),
length(dat_1$ID[which(dat_1$Trait.type == "Prevalence")]),
length(dat_1$ID[which(dat_1$Trait.type == "Intensity")]),
length(dat_1$ID[grep("demographic", dat_1$Trait.category)]),
length(dat_1$ID[which(dat_1$Trait.type == "Survivorship")]),
length(dat_1$ID[which(dat_1$Trait.type == "Fecundity")])
),
Question_2 = c(
length(unique(dat_2$Study)),
length(dat_2$g),
length(unique(dat_2$Experiment)),
length(unique(dat_2$Host[which(dat_2$Host.type == "Arthropod")])),
length(unique(dat_2$Host[which(dat_2$Host.type == "Mollusc")])),
length(unique(dat_2$Host[which(dat_2$Host.type == "Fish")])),
length(unique(dat_2$Host[which(dat_2$Host.type == "Amphibian")])),
length(unique(dat_2$Host[which(dat_2$Host.type == "Reptile")])),
length(unique(dat_2$Host[which(dat_2$Host.type == "Bird")])),
length(unique(dat_2$Host[which(dat_2$Host.type == "Mammal")])),
length(unique(dat_2$Parasite[which(dat_2$Parasite.type ==
"Virus")])),
length(unique(dat_2$Parasite[which(dat_2$Parasite.type ==
"Bacteria")])),
length(unique(dat_2$Parasite[which(dat_2$Parasite.type ==
"Multiple")])),
length(unique(dat_2$Parasite[which(dat_2$Parasite.type ==
"Fungus")])),
length(unique(dat_2$Parasite[which(dat_2$Parasite.type ==
"Protozoan")])),
length(unique(dat_2$Parasite[which(dat_2$Parasite.type ==
"Helminth")])),
length(dat_2$Experiment[which(dat_2$Gradient.category ==
"Environment")]),
length(dat_2$Experiment[which(dat_2$Gradient.category ==
"Pollution")]),
length(dat_2$Experiment[which(dat_2$Gradient.category ==
"Resource")]),
length(dat_2$ID[which(dat_2$Trait.category == "Epidemiological")]),
length(dat_2$ID[which(dat_2$Trait.type == "Prevalence")]),
length(dat_2$ID[which(dat_2$Trait.type == "Intensity")]),
length(dat_2$ID[grep("demographic", dat_2$Trait.category)]),
length(dat_2$ID[which(dat_2$Trait.type == "Survivorship")]),
length(dat_2$ID[which(dat_2$Trait.type == "Fecundity")])
),
Question_3 = c(
length(unique(dat_3$Study)),
length(dat_3$g),
length(unique(dat_3$Experiment)),
length(unique(dat_3$Host[which(dat_3$Host.type == "Arthropod")])),
length(unique(dat_3$Host[which(dat_3$Host.type == "Mollusc")])),
length(unique(dat_3$Host[which(dat_3$Host.type == "Fish")])),
length(unique(dat_3$Host[which(dat_3$Host.type == "Amphibian")])),
length(unique(dat_3$Host[which(dat_3$Host.type == "Reptile")])),
length(unique(dat_3$Host[which(dat_3$Host.type == "Bird")])),
length(unique(dat_3$Host[which(dat_3$Host.type == "Mammal")])),
length(unique(dat_3$Parasite[which(dat_3$Parasite.type ==
"Virus")])),
length(unique(dat_3$Parasite[which(dat_3$Parasite.type ==
"Bacteria")])),
length(unique(dat_3$Parasite[which(dat_3$Parasite.type ==
"Multiple")])),
length(unique(dat_3$Parasite[which(dat_3$Parasite.type ==
"Fungus")])),
length(unique(dat_3$Parasite[which(dat_3$Parasite.type ==
"Protozoan")])),
length(unique(dat_3$Parasite[which(dat_3$Parasite.type ==
"Helminth")])),
length(dat_3$Experiment[which(dat_3$Gradient.category ==
"Environment")]),
length(dat_3$Experiment[which(dat_3$Gradient.category ==
"Pollution")]),
length(dat_3$Experiment[which(dat_3$Gradient.category ==
"Resource")]),
length(dat_3$ID[which(dat_3$Trait.category == "Epidemiological")]),
length(dat_3$ID[which(dat_3$Trait.type == "Prevalence")]),
length(dat_3$ID[which(dat_3$Trait.type == "Intensity")]),
length(dat_3$ID[grep("demographic", dat_3$Trait.category)]),
length(dat_3$ID[which(dat_3$Trait.type == "Survivorship")]),
length(dat_3$ID[which(dat_3$Trait.type == "Fecundity")])
)
)
d_stats %>%
kbl() %>%
kable_material(c("striped", "hover"), full_width = F)
Q1m1 <-
rma.mv(
g ~ 1,
V = varcovmat_1_PD$mat,
random = list( ~ 1 | as.factor(ID), ~ 1 | as.factor(Experiment), ~ 1 | Parasite),
data = dat_1,
method = "REML"
)
summary(Q1m1)
Q1m2 <-
rma.mv(
g ~ Trait.category:Trait.type -1,
V = varcovmat_1_PD$mat,
random = list( ~ 1 | as.factor(ID), ~ 1 | as.factor(Experiment), ~ 1 | Parasite),
data = dat_1,
method = "REML"
)
summary(Q1m2)
forest.default(x= Q1m2$beta, sei =  Q1m2$se, ci.lb =  Q1m2$ci.lb, ci.ub =  Q1m2$ci.ub,
annotate=TRUE, showweights=T, header=F,
slab = c("Infected fecundity", "Uninfected fecundity",
"Infected survivorship", "Uninfected survivorship"))
Q1m3 <-
rma.mv(
g ~ Trait.category : Trait.type : Gradient.category -1,
V = varcovmat_1_PD$mat,
random = list( ~ 1 | as.factor(ID), ~ 1 | as.factor(Experiment), ~ 1 | Parasite),
data = dat_1,
method = "REML"
)
summary(Q1m3)
forest.default(x= Q1m3$beta, sei =  Q1m3$se, ci.lb =  Q1m3$ci.lb, ci.ub =  Q1m3$ci.ub,
annotate=TRUE, showweights=T, header=F,
slab = c("Environment infected fecundity", "Environment uninfected fecundity", "Environment infected survivorship", "Environment uninfected survivorship", "Pollution infected fecundity", "Pollution uninfected fecundity", "Pollution infected survivorship", "Pollution uninfected survivorship", "Resource infected fecundity", "Resource uninfected fecundity", "Resource infected survivorship", "Resource uninfected survivorship"))
Q1m4 <-
rma.mv(
g ~ Trait.type:Gradient.category -1 ,
V = varcovmat_1_PD$mat,
random = list( ~ 1 | as.factor(ID), ~ 1 | as.factor(Experiment), ~ 1 | Parasite),
data = dat_1,
method = "REML"
)
summary(Q1m4)
forest.default(x= Q1m4$beta, sei =  Q1m4$se, ci.lb =  Q1m4$ci.lb, ci.ub =  Q1m4$ci.ub,
annotate=TRUE, showweights=T, header=F,
slab = c("Environment fecundity", "Environment survivorship", "Pollution  fecundity", "Pollution  survivorship", "Resource  fecundity", "Resource  survivorship"))
Q1m5 <-
rma.mv(
g ~ Trait.category:Host.type.2 -1,
V = varcovmat_1_PD$mat,
random = list( ~ 1 | ID, ~ 1 | Experiment, ~ 1 | Parasite),
data = dat_1,
method = "REML"
)
summary(Q1m5)
forest.default(x= Q1m5$beta, sei =  Q1m5$se, ci.lb =  Q1m5$ci.lb, ci.ub =  Q1m5$ci.ub,
annotate=TRUE, showweights=T, header=F,
slab = c("Invertebrate infected", "Invertebrate uninfected", "Vertebrate infected", "Vertebrate  uninfected"))
Q1m6 <-
rma.mv(
g ~ Trait.category:Gradient.category:Host.type.2 -1,
V = varcovmat_1_PD$mat,
random = list( ~ 1 | ID, ~ 1 | Experiment, ~ 1 | Parasite),
data = dat_1,
method = "REML"
)
summary(Q1m6)
forest.default(x= Q1m6$beta, sei =  Q1m6$se, ci.lb =  Q1m6$ci.lb, ci.ub =  Q1m6$ci.ub,
annotate=TRUE, showweights=T, header=F,
slab = c("Environment invertebrate infected", "Environment invertebrate uninfected", "Pollution invertebrate infected", "Pollution invertebrate uninfected", "Resource invertebrate infected", "Resource invertebrate uninfected", "Environment vertebrate infected", "Environment vertebrate uninfected", "Pollution vertebrate infected", "Pollution vertebrate uninfected", "Resource vertebrate infected", "Resource vertebrate uninfected"))
Q1m7 <-
rma.mv(
g ~ Gradient.category:Host.type.2 -1,
V = varcovmat_1_PD$mat,
random = list( ~ 1 | ID, ~ 1 | Experiment, ~ 1 | Parasite),
data = dat_1,
method = "REML"
)
summary(Q1m7)
forest.default(x= Q1m7$beta, sei =  Q1m7$se, ci.lb =  Q1m7$ci.lb, ci.ub =  Q1m7$ci.ub,
annotate=TRUE, showweights=T, header=F,
slab = c("Environment invertebrate", "Pollution invertebrate", "Resource invertebrate", "Environment vertebrate", "Pollution vertebrate", "Resource vertebrate "))
Q2m1 <-
rma.mv(
g ~ 1,
V = varcovmat_2_PD$mat,
random = list( ~ 1 | as.factor(ID), ~ 1 | as.factor(Experiment), ~ 1 | Parasite),
data = dat_2,
method = "REML"
)
summary(Q2m1)
Q2m2 <-
rma.mv(
g ~ Trait.type -1 ,
V = varcovmat_2_PD$mat,
random = list( ~ 1 | as.factor(ID), ~ 1 | as.factor(Experiment), ~ 1 | Parasite),
data = dat_2,
method = "REML"
)
summary(Q2m2)
forest.default(x= Q2m2$beta, sei =  Q2m2$se, ci.lb =  Q2m2$ci.lb, ci.ub =  Q2m2$ci.ub,
annotate=TRUE, showweights=T, header=F,
slab = c("Intensity", "Prevalence"))
Q2m3 <-
rma.mv(
g ~ Trait.type : Gradient.category -1,
V = varcovmat_2_PD$mat,
random = list( ~ 1 | as.factor(ID), ~ 1 | as.factor(Experiment), ~ 1 | Parasite),
data = dat_2,
method = "REML"
)
summary(Q2m3)
forest.default(x= Q2m3$beta, sei =  Q2m3$se, ci.lb =  Q2m3$ci.lb, ci.ub =  Q2m3$ci.ub,
annotate=TRUE, showweights=T, header=F,
slab = c("Environment intensity", "Environment prevalence", "Pollution intensity", "Pollution prevalence", "Resource intensity", "Resource prevalence"))
Q2m4 <-
rma.mv(
g ~ Trait.type:Host.type.2:Gradient.category -1,
V = varcovmat_2_PD$mat,
random = list( ~ 1 | ID, ~ 1 | Experiment, ~ 1 | Parasite),
data = dat_2,
method = "REML"
)
summary(Q2m4)
forest.default(x= Q2m4$beta, sei =  Q2m4$se, ci.lb =  Q2m4$ci.lb, ci.ub =  Q2m4$ci.ub,
annotate=TRUE, showweights=T, header=F,
slab = c("Environment invertebrate intensity", "Environment invertebrate prevalence", "Environment vertebrate intensity", "Environment vertebrate prevalence", "Pollution invertebrate intensity", "Pollution invertebrate prevalence", "Pollution vertebrate intensity", "Pollution vertebrate prevalence", "Resource invertebrate intensity", "Resource invertebrate prevalence", "Resource vertebrate intensity", "Resource vertebrate prevalence"))
Q3m1 <-
rma.mv(
g ~ 1,
V = varcovmat_3_PD$mat,
random = list( ~ 1 | ID, ~ 1 | Experiment, ~ 1 | Parasite),
data = dat_3,
method = "REML"
)
summary(Q3m1)
#note that this is WITH absolute value --> which one is more sensible. Both are significant.
Q3m2.1 <-
rma.mv(
abs(g) ~ Trait.category -1,
V = varcovmat_3_PD$mat,
random = list( ~ 1 | ID, ~ 1 | Experiment, ~ 1 | Parasite),
data = dat_3,
method = "REML"
)
summary(Q3m2.1)
forest.default(x= Q3m2.1$beta, sei =  Q3m2.1$se, ci.lb =  Q3m2.1$ci.lb, ci.ub =  Q3m2.1$ci.ub,
annotate=TRUE, showweights=T, header=F,
slab = c("Resistance", "Fitness"))
#note that this is WITHOUT absolute value --> In here, resistance is not significant. Which means that the responses to stress are all over the place, while for the fitness trait is always a negative effect. Could be explained by dying individuals when getting infected, which might look like an increase in resistance (??)
Q3m2.2 <-
rma.mv(
g ~ Trait.category -1,
V = varcovmat_3_PD$mat,
random = list( ~ 1 | ID, ~ 1 | Experiment, ~ 1 | Parasite),
data = dat_3,
method = "REML"
)
summary(Q3m2.2)
forest.default(x= Q3m2.2$beta, sei =  Q3m2.2$se, ci.lb =  Q3m2.2$ci.lb, ci.ub =  Q3m2.2$ci.ub,
annotate=TRUE, showweights=T, header=F,
slab = c("Resistance", "Fitness"))
Q3m3 <-
rma.mv(
g ~ Trait.category:Gradient.category -1,
V = varcovmat_3_PD$mat,
random = list( ~ 1 | ID, ~ 1 | Experiment, ~ 1 | Parasite),
data = dat_3,
method = "REML"
)
summary(Q3m3)
forest.default(x= Q3m3$beta, sei =  Q3m3$se, ci.lb =  Q3m3$ci.lb, ci.ub =  Q3m3$ci.ub,
annotate=TRUE, showweights=T, header=F,
slab = c("Environment resistance", "Environment fitness", "Pollution resistance", "Pollution fitness", "Resource resistance", "Resource fitness"))
Q3m4 <-
rma.mv(
g ~ Trait.type:Gradient.category -1,
V = varcovmat_3_PD$mat,
random = list( ~ 1 | ID, ~ 1 | Experiment, ~ 1 | Parasite),
data = dat_3,
method = "REML",
)
summary(Q3m4)
forest.default(x= Q3m4$beta, sei =  Q3m4$se, ci.lb =  Q3m4$ci.lb, ci.ub =  Q3m4$ci.ub,
annotate=TRUE, showweights=T, header=F,
slab = c("Environment fecundity", "Environment intensity", "Environment prevalence", "Environment survivorship", "Pollution fecundity", "Pollution intensity", "Pollution prevalence", "Pollution survivorship", "Resource fecundity", "Resource intensity", "Resource prevalence", "Resource survivorship"))
Q3m5 <-
rma.mv(
g ~ Trait.category:Host.type.2 -1,
V = varcovmat_3_PD$mat,
random = list( ~ 1 | ID, ~ 1 | Experiment, ~ 1 | Parasite),
data = dat_3,
method = "REML",
)
summary(Q3m5)
forest.default(x= Q3m5$beta, sei =  Q3m5$se, ci.lb =  Q3m5$ci.lb, ci.ub =  Q3m5$ci.ub,
annotate=TRUE, showweights=T, header=F,
slab = c("Resistance invertebrate", "Fitness invertebrate", "Resistance vertebrate", "Fitness vertebrate"))
Q3m6 <-
rma.mv(
g ~ Trait.category:Host.type.2:Gradient.category -1,
V = varcovmat_3_PD$mat,
random = list( ~ 1 | ID, ~ 1 | Experiment, ~ 1 | Parasite),
data = dat_3,
method = "REML",
)
summary(Q3m6)
forest.default(x= Q3m6$beta, sei =  Q3m6$se, ci.lb =  Q3m6$ci.lb, ci.ub =  Q3m6$ci.ub,
annotate=TRUE, showweights=T, header=F,
slab = c("Environment invertebrate resistance", "Environment invertebrate fitness", "Environment vertebrate resistance", "Environment vertebrate fitness", "Pollution invertebrate resistance", "Pollution invertebrate fitness", "Pollution vertebrate resistance", "Pollution vertebrate fitness", "Resource invertebrate resistance", "Resource invertebrate fitness", "Resource vertebrate resistance", "Resource vertebrate fitness"))
?forest.default
Q1m2 <-
rma.mv(
g ~ Trait.category:Trait.type -1,
V = varcovmat_1_PD$mat,
random = list( ~ 1 | as.factor(ID), ~ 1 | as.factor(Experiment), ~ 1 | Parasite),
data = dat_1,
method = "REML"
)
summary(Q1m2)
forest.default(x= Q1m2$beta, sei =  Q1m2$se, ci.lb =  Q1m2$ci.lb, ci.ub =  Q1m2$ci.ub,
annotate=TRUE, showweights=T, header=T,
slab = c("Infected fecundity", "Uninfected fecundity",
"Infected survivorship", "Uninfected survivorship"))
#note that this is WITHOUT absolute value --> In here, resistance is not significant. Which means that the responses to stress are all over the place, while for the fitness trait is always a negative effect. Could be explained by dying individuals when getting infected, which might look like an increase in resistance (??)
Q3m2.2 <-
rma.mv(
g ~ Trait.category -1,
V = varcovmat_3_PD$mat,
random = list( ~ 1 | ID, ~ 1 | Experiment, ~ 1 | Parasite),
data = dat_3,
method = "REML"
)
summary(Q3m2.2)
forest.default(x= Q3m2.2$beta, sei =  Q3m2.2$se, ci.lb =  Q3m2.2$ci.lb, ci.ub =  Q3m2.2$ci.ub,
annotate=TRUE, showweights=T, header=F,
slab = c("Epidemiological", "Fitness"))
#note that this is WITH absolute value --> which one is more sensible. Both are significant.
Q3m2.1 <-
rma.mv(
abs(g) ~ Trait.category -1,
V = varcovmat_3_PD$mat,
random = list( ~ 1 | ID, ~ 1 | Experiment, ~ 1 | Parasite),
data = dat_3,
method = "REML"
)
summary(Q3m2.1)
forest.default(x= Q3m2.1$beta, sei =  Q3m2.1$se, ci.lb =  Q3m2.1$ci.lb, ci.ub =  Q3m2.1$ci.ub,
annotate=TRUE, showweights=T, header=F,
slab = c("Epidemiological", "Fitness"))
